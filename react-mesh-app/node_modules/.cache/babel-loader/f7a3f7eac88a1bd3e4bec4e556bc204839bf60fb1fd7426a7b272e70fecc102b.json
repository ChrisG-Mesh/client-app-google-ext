{"ast":null,"code":"import React,{useState,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OpenLink=()=>{const[iFrameUrl,setIFrameUrl]=useState(null);const[showIframe,setShowIframe]=useState(false);const[authToken,setAuthToken]=useState(null);useEffect(()=>{const handleMessage=event=>{// Replace 'http://localhost:3000' with the actual origin of your iframe\nconst expectedOrigin='http://localhost:3000';if(event.origin!==expectedOrigin){console.warn(\"Ignored message from origin: \".concat(event.origin));return;}const{data}=event;if(data.event==='authenticate'&&data.auth_token){setAuthToken(data.auth_token);localStorage.setItem('auth_token',data.auth_token);// Optionally store in local storage\n}else if(data.error){console.error('Error received from iframe:',data.error);}};window.addEventListener('message',handleMessage);return()=>{window.removeEventListener('message',handleMessage);};},[]);const fetchData=async()=>{try{const response=await fetch('http://localhost:3000/api/getCatalogLink',{method:'GET',headers:{'Accept':'application/json','Content-Type':'application/json'}});if(!response.ok){throw new Error('Network response error');}const result=await response.json();setIFrameUrl(result.iFrameUrl);}catch(error){console.error('Error fetching the API',error);}};const handleOpenIframe=()=>{if(!iFrameUrl){fetchData();}setShowIframe(true);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleOpenIframe,children:\"Open Mesh\"}),showIframe&&iFrameUrl&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Catalog Link success\"}),/*#__PURE__*/_jsx(\"iframe\",{src:iFrameUrl,style:{width:'400px',height:'600px',border:'none'}})]}),authToken&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Authenticated successfully with token: \",authToken]})]});};export default OpenLink;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","OpenLink","iFrameUrl","setIFrameUrl","showIframe","setShowIframe","authToken","setAuthToken","handleMessage","event","expectedOrigin","origin","console","warn","concat","data","auth_token","localStorage","setItem","error","window","addEventListener","removeEventListener","fetchData","response","fetch","method","headers","ok","Error","result","json","handleOpenIframe","children","onClick","src","style","width","height","border"],"sources":["/Users/christopher.gentibano/Desktop/Google Extension Project/google-ext/react-mesh-app/src/components/OpenLink.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nconst OpenLink = () => {\n  const [iFrameUrl, setIFrameUrl] = useState(null);\n  const [showIframe, setShowIframe] = useState(false);\n  const [authToken, setAuthToken] = useState(null);\n\n  useEffect(() => {\n    const handleMessage = (event) => {\n      // Replace 'http://localhost:3000' with the actual origin of your iframe\n      const expectedOrigin = 'http://localhost:3000';\n\n      if (event.origin !== expectedOrigin) {\n        console.warn(`Ignored message from origin: ${event.origin}`);\n        return;\n      }\n\n      const { data } = event;\n      if (data.event === 'authenticate' && data.auth_token) {\n        setAuthToken(data.auth_token);\n        localStorage.setItem('auth_token', data.auth_token); // Optionally store in local storage\n      } else if (data.error) {\n        console.error('Error received from iframe:', data.error);\n      }\n    };\n\n    window.addEventListener('message', handleMessage);\n\n    return () => {\n      window.removeEventListener('message', handleMessage);\n    };\n  }, []);\n\n  const fetchData = async () => {\n    try {\n      const response = await fetch('http://localhost:3000/api/getCatalogLink', {\n        method: 'GET',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json',\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error('Network response error');\n      }\n\n      const result = await response.json();\n      setIFrameUrl(result.iFrameUrl);\n    } catch (error) {\n      console.error('Error fetching the API', error);\n    }\n  };\n\n  const handleOpenIframe = () => {\n    if (!iFrameUrl) {\n      fetchData();\n    }\n    setShowIframe(true);\n  };\n\n  return (\n    <div>\n      <button onClick={handleOpenIframe}>Open Mesh</button>\n      {showIframe && iFrameUrl && (\n        <div>\n          <h3>Catalog Link success</h3>\n          <iframe src={iFrameUrl} style={{ width: '400px', height: '600px', border: 'none' }} />\n        </div>\n      )}\n      {authToken && (\n        <p>Authenticated successfully with token: {authToken}</p>\n      )}\n    </div>\n  );\n};\n\nexport default OpenLink;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnD,KAAM,CAAAC,QAAQ,CAAGA,CAAA,GAAM,CACrB,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGR,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAACS,UAAU,CAAEC,aAAa,CAAC,CAAGV,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAACW,SAAS,CAAEC,YAAY,CAAC,CAAGZ,QAAQ,CAAC,IAAI,CAAC,CAEhDC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAY,aAAa,CAAIC,KAAK,EAAK,CAC/B;AACA,KAAM,CAAAC,cAAc,CAAG,uBAAuB,CAE9C,GAAID,KAAK,CAACE,MAAM,GAAKD,cAAc,CAAE,CACnCE,OAAO,CAACC,IAAI,iCAAAC,MAAA,CAAiCL,KAAK,CAACE,MAAM,CAAE,CAAC,CAC5D,OACF,CAEA,KAAM,CAAEI,IAAK,CAAC,CAAGN,KAAK,CACtB,GAAIM,IAAI,CAACN,KAAK,GAAK,cAAc,EAAIM,IAAI,CAACC,UAAU,CAAE,CACpDT,YAAY,CAACQ,IAAI,CAACC,UAAU,CAAC,CAC7BC,YAAY,CAACC,OAAO,CAAC,YAAY,CAAEH,IAAI,CAACC,UAAU,CAAC,CAAE;AACvD,CAAC,IAAM,IAAID,IAAI,CAACI,KAAK,CAAE,CACrBP,OAAO,CAACO,KAAK,CAAC,6BAA6B,CAAEJ,IAAI,CAACI,KAAK,CAAC,CAC1D,CACF,CAAC,CAEDC,MAAM,CAACC,gBAAgB,CAAC,SAAS,CAAEb,aAAa,CAAC,CAEjD,MAAO,IAAM,CACXY,MAAM,CAACE,mBAAmB,CAAC,SAAS,CAAEd,aAAa,CAAC,CACtD,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAe,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,0CAA0C,CAAE,CACvEC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,QAAQ,CAAE,kBAAkB,CAC5B,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CAEF,GAAI,CAACH,QAAQ,CAACI,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAC,KAAK,CAAC,wBAAwB,CAAC,CAC3C,CAEA,KAAM,CAAAC,MAAM,CAAG,KAAM,CAAAN,QAAQ,CAACO,IAAI,CAAC,CAAC,CACpC5B,YAAY,CAAC2B,MAAM,CAAC5B,SAAS,CAAC,CAChC,CAAE,MAAOiB,KAAK,CAAE,CACdP,OAAO,CAACO,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAChD,CACF,CAAC,CAED,KAAM,CAAAa,gBAAgB,CAAGA,CAAA,GAAM,CAC7B,GAAI,CAAC9B,SAAS,CAAE,CACdqB,SAAS,CAAC,CAAC,CACb,CACAlB,aAAa,CAAC,IAAI,CAAC,CACrB,CAAC,CAED,mBACEL,KAAA,QAAAiC,QAAA,eACEnC,IAAA,WAAQoC,OAAO,CAAEF,gBAAiB,CAAAC,QAAA,CAAC,WAAS,CAAQ,CAAC,CACpD7B,UAAU,EAAIF,SAAS,eACtBF,KAAA,QAAAiC,QAAA,eACEnC,IAAA,OAAAmC,QAAA,CAAI,sBAAoB,CAAI,CAAC,cAC7BnC,IAAA,WAAQqC,GAAG,CAAEjC,SAAU,CAACkC,KAAK,CAAE,CAAEC,KAAK,CAAE,OAAO,CAAEC,MAAM,CAAE,OAAO,CAAEC,MAAM,CAAE,MAAO,CAAE,CAAE,CAAC,EACnF,CACN,CACAjC,SAAS,eACRN,KAAA,MAAAiC,QAAA,EAAG,yCAAuC,CAAC3B,SAAS,EAAI,CACzD,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAAL,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}