{"ast":null,"code":"import React,{useState,useEffect}from'react';import{createLink}from'@meshconnect/web-link-sdk';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const PopupWindow=_ref=>{let{linkToken}=_ref;const[linkConnection,setLinkConnection]=useState(null);const[error,setError]=useState(null);const[loading,setLoading]=useState(false);useEffect(()=>{console.log(linkToken);if(linkToken){const link=createLink({clientId:\"b7007f87-c050-40cf-7777-08dc6f959a47\",// Replace with your client ID\nonIntegrationConnected:data=>{console.log('Integration connected:',data);},onEvent:event=>{console.info('Mesh EVENT',event);if(event.type==='close'){console.log('Close event occurred in Mesh modal');window.close();// Close popup window on integration close event\n}},onExit:error=>{if(error){console.error('Link exited with error:',error);}else{console.log('Link exited successfully');}}});setLinkConnection(link);}},[linkToken]);const handleOpenLinkClick=async()=>{console.log(linkToken);if(!linkToken){setError('Link token not fetched yet.');return;}try{await linkConnection.openLink(linkToken,{onSuccess:()=>{console.log('Link opened successfully in popup');},onError:error=>{console.error('Error opening link in popup:',error);alert('Failed to open link. Please try again.');}});}catch(error){console.error('Error opening link in popup:',error);alert('Failed to open link. Please try again.');}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Popup Window\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[error&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Error: \",error]}),linkToken&&/*#__PURE__*/_jsx(\"button\",{onClick:handleOpenLinkClick,disabled:loading,children:\"Open Link\"})]})]});};export default PopupWindow;","map":{"version":3,"names":["React","useState","useEffect","createLink","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PopupWindow","_ref","linkToken","linkConnection","setLinkConnection","error","setError","loading","setLoading","console","log","link","clientId","onIntegrationConnected","data","onEvent","event","info","type","window","close","onExit","handleOpenLinkClick","openLink","onSuccess","onError","alert","children","onClick","disabled"],"sources":["/Users/christopher.gentibano/Desktop/Google Extension Project/google-ext/react-mesh-app/src/components/PopupWindow.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { createLink } from '@meshconnect/web-link-sdk';\n\nconst PopupWindow = ({ linkToken }) => {\n  const [linkConnection, setLinkConnection] = useState(null);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    console.log(linkToken)\n    if (linkToken) {\n      const link = createLink({\n        clientId: \"b7007f87-c050-40cf-7777-08dc6f959a47\", // Replace with your client ID\n        onIntegrationConnected: (data) => {\n          console.log('Integration connected:', data);\n        },\n        onEvent: (event) => {\n          console.info('Mesh EVENT', event);\n          if (event.type === 'close') {\n            console.log('Close event occurred in Mesh modal');\n            window.close(); // Close popup window on integration close event\n          }\n        },\n        onExit: (error) => {\n          if (error) {\n            console.error('Link exited with error:', error);\n          } else {\n            console.log('Link exited successfully');\n          }\n        }\n      });\n      setLinkConnection(link);\n    }\n  }, [linkToken]);\n\n  const handleOpenLinkClick = async () => {\n    console.log(linkToken)\n    if (!linkToken) {\n      setError('Link token not fetched yet.');\n      return;\n    }\n\n    try {\n      await linkConnection.openLink(linkToken, {\n        onSuccess: () => {\n          console.log('Link opened successfully in popup');\n        },\n        onError: (error) => {\n          console.error('Error opening link in popup:', error);\n          alert('Failed to open link. Please try again.');\n        }\n      });\n    } catch (error) {\n      console.error('Error opening link in popup:', error);\n      alert('Failed to open link. Please try again.');\n    }\n  };\n\n  return (\n    <div>\n      <h1>Popup Window</h1>\n      {loading ? <p>Loading...</p> : (\n        <>\n          {error && <p>Error: {error}</p>}\n          {linkToken && (\n            <button onClick={handleOpenLinkClick} disabled={loading}>\n              Open Link\n            </button>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default PopupWindow;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}